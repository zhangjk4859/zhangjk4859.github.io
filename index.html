<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"pluscool.cn","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="种点粮食">
<meta property="og:type" content="website">
<meta property="og:title" content="加酷知识源">
<meta property="og:url" content="https://pluscool.cn/index.html">
<meta property="og:site_name" content="加酷知识源">
<meta property="og:description" content="种点粮食">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="张俊凯">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://pluscool.cn/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>加酷知识源</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">加酷知识源</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://pluscool.cn/2021/07/19/know/how-to-learn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="张俊凯">
      <meta itemprop="description" content="种点粮食">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="加酷知识源">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/19/know/how-to-learn/" class="post-title-link" itemprop="url">如何吸收知识</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-07-19 11:37:46 / Modified: 12:17:22" itemprop="dateCreated datePublished" datetime="2021-07-19T11:37:46+08:00">2021-07-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%8F%91%E8%A7%89/" itemprop="url" rel="index"><span itemprop="name">发觉</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​    今天看耗子哥新文<a target="_blank" rel="noopener" href="https://coolshell.cn/articles/21589.html">如何做一个有质量的技术分享</a>，文末做了一个分享示例</p>
<blockquote>
<p>For example, if you want to sharing a topic about Docker. the following outlines would be good one:</p>
<ul>
<li>What’s the major problems need to solve. (Provision, Environment, Isolation etc.)</li>
<li>The Alternative solutions. (Puppet/Chef/Ansible, VM, LXC etc.)</li>
<li>The Best Solution – Docker. Why?</li>
<li>Docker’s key techniques – image, cgroup, union fs, namespace…</li>
<li>Docker’s Pros/Cons</li>
<li>Further reading list.</li>
</ul>
</blockquote>
<p>感觉吸收新知识也是同理，建立一个问题，引起好奇心，然后顺理成章往下推演，看现在的最佳解决方案（知识）是怎么经过筛选得来的。</p>
<p>下面是自己收集的一些tips供自己参考，持续更新：</p>
<ul>
<li>teach someone else</li>
<li>learn in short bursts of time </li>
<li>take notes by hand</li>
<li>take a study nap</li>
<li>the human brain <a target="_blank" rel="noopener" href="http://misrc.umn.edu/workingpapers/fullpapers/1986/8611.pdf">processes images</a> 60,000 times faster than text, and 90 percent of information transmitted to the brain <a target="_blank" rel="noopener" href="http://newsoffice.mit.edu/2014/in-the-blink-of-an-eye-0116">is visual</a></li>
</ul>
<p>参考：<a target="_blank" rel="noopener" href="https://www.fastcompany.com/3063173/six-brain-hacks-to-learn-anything-faster">learn anything faster</a></p>
<p><a target="_blank" rel="noopener" href="https://www.t-sciences.com/news/humans-process-visual-data-better">Humans Process Visual Data Better</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://pluscool.cn/2021/07/19/cs/add-https-on-blog/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="张俊凯">
      <meta itemprop="description" content="种点粮食">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="加酷知识源">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/19/cs/add-https-on-blog/" class="post-title-link" itemprop="url">给自己的博客域名加https</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-07-19 09:51:15 / Modified: 10:33:53" itemprop="dateCreated datePublished" datetime="2021-07-19T09:51:15+08:00">2021-07-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/" itemprop="url" rel="index"><span itemprop="name">计算机</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​    一开始想添加一个博客评论系统，方便交流，参考的是<a target="_blank" rel="noopener" href="https://freemind.pluskid.org/technology/github-based-comment-system-and-the-death-of-independent-blog/">kid的博客</a>，选择最简单的方案 <a target="_blank" rel="noopener" href="https://utteranc.es/">utteranc.es</a>，hexo已经有<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/76237379">插件集成</a>，使用的是npm安装。安装完成后在博客底部成功出现评论框</p>
<p><img src="https://github.com/zhangjk4859/zhangjk4859.github.io/blob/zjk/pics/comment-box.jpg?raw=true" alt="comment-box.jpg"></p>
<p>点击github登录时出现了访问失败，找不到资源</p>
<p><img src="https://github.com/zhangjk4859/zhangjk4859.github.io/blob/zjk/pics/domain404.jpg?raw=true" alt="image"></p>
<p>经过测试，确定原因是自己域名没有https的原因，链接添加参数后默认以https访问出现请求失败情况。首先想到的是去阿里万网看自带的服务，价格有些小贵<img src="https://github.com/zhangjk4859/zhangjk4859.github.io/blob/zjk/pics/wanwangprice.png?raw=true" alt="image"></p>
<p>为了秉持互联网免费原则，确定了<a target="_blank" rel="noopener" href="https://jaeger.itscoder.com/web/2017/08/30/github-page-https.html">Netlify方案</a>,根据教程配置完成后大概等了半天时间，https域名就可以正常使用了。</p>
<p>没有尝试的方案：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/zaq0123/article/details/79880838">阿里云一年免费</a></li>
<li><a target="_blank" rel="noopener" href="https://tzhou2018.github.io/2018/04/%E4%B8%BAGitHub-Pages%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E5%B9%B6%E6%B7%BB%E5%8A%A0SSL-%E5%BC%80%E5%90%AFHTTPS%E5%BC%BA%E5%88%B6/">cloud flare免费方案</a></li>
</ul>
<p>最后，感谢<a target="_blank" rel="noopener" href="https://blog.lanweihong.com/posts/24011/">蓝伟洪</a>和<a target="_blank" rel="noopener" href="https://yanqizhao.com/">小蘑菇</a>配合测试评论系统。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://pluscool.cn/2021/07/02/flutter/flutter-double-engine/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="张俊凯">
      <meta itemprop="description" content="种点粮食">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="加酷知识源">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/02/flutter/flutter-double-engine/" class="post-title-link" itemprop="url">flutter安卓开启第二引擎跑网页</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-07-02 11:43:01 / Modified: 17:38:06" itemprop="dateCreated datePublished" datetime="2021-07-02T11:43:01+08:00">2021-07-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/flutter/" itemprop="url" rel="index"><span itemprop="name">flutter</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​    在纯flutter应用里打开网页，目前流行两个插件:</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://pub.flutter-io.cn/packages/flutter_webview_plugin">flutter_webview_plugin</a> (以下简称<strong>三方web</strong>)</p>
<ul>
<li><p>特点</p>
<blockquote>
<p>1.实测中滑动相对流畅</p>
<p>2.bug较少</p>
<p>3.不在flutter的widget tree中，视图在app最顶层，通过channel通知来实现显示和隐藏，全局是一个单例</p>
<p>4.非官方</p>
</blockquote>
</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://pub.flutter-io.cn/packages/webview_flutter">webview_flutter</a>(以下简称<strong>官方web</strong>)</p>
<ul>
<li><p>特点</p>
<blockquote>
<p>1.镶嵌在widget tree中，方便在flutter中控制</p>
<p>2.键盘弹出有部分bug</p>
<p>3.官方支持</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<p>由于历史原因和开发成本考虑，继续沿用三方web作为浏览器，遇到一个需求，就是需要打开网页的时候秒开，实现类似<a target="_blank" rel="noopener" href="https://blog.csdn.net/zhenghhgz/article/details/112302985">今日头条的效果</a>，经过调研和结合flutter特性，最终方案定型为下图</p>
<p><img src="https://github.com/zhangjk4859/zhangjk4859.github.io/blob/zjk/pics/android-flutter-db-engine.png?raw=true" alt="image"></p>
<p><img src="https://github.com/zhangjk4859/zhangjk4859.github.io/blob/zjk/pics/iOS-flutter-db-engine.png?raw=true" alt="image"></p>
<p>​    在实现iOS过程中比较顺利，在appdelegate启动的时候加载WebViewController放在后台待命，MainViewController新增一个导航在合适的时候来push WebViewController</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> webViewEngine:<span class="type">FlutterEngine</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> engine = <span class="type">FlutterEngine</span>(name: <span class="string">&quot;webViewEngineName&quot;</span>)</span><br><span class="line">        engine.run(withEntrypoint: <span class="string">&quot;webViewMain&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> engine</span><br><span class="line">    &#125;()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> webViewFlutterVC:<span class="type">FlutterViewController</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> webFlutterVC = <span class="type">FlutterViewController</span>(engine: <span class="keyword">self</span>.webViewEngine, nibName: <span class="literal">nil</span>, bundle: <span class="literal">nil</span>)</span><br><span class="line">        webFlutterVC.view.backgroundColor = <span class="type">UIColor</span>.white</span><br><span class="line">        <span class="keyword">return</span> webFlutterVC</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> registerWebFlutterVC: <span class="type">Void</span> = &#123;</span><br><span class="line">        <span class="type">CopiedPluginRegistrant</span>.register(with: <span class="keyword">self</span>.webViewFlutterVC)   </span><br><span class="line">        &#125;()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="number">_</span> application: UIApplication,</span></span></span><br><span class="line"><span class="function"><span class="params">    didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: <span class="keyword">Any</span>]?</span></span></span><br><span class="line"><span class="function"><span class="params">  )</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="comment">//启动WebViewController</span></span><br><span class="line">    <span class="number">_</span> = <span class="keyword">self</span>.registerWebFlutterVC</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.application(application, didFinishLaunchingWithOptions: launchOptions)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>同样的原理框架在实现安卓的时候因为实现原理不同，做了改动：</p>
<ol>
<li>两个页面均由activity实现，在安卓app启动的时候需要指定一个activity作为单例launcher，把web activity作为launcher先启动，等内部webview预热完成，再启动main activity</li>
</ol>
<p>manifest文件配置</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;.FlutterWebViewActivity&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:launchMode</span>=<span class="string">&quot;singleInstance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:theme</span>=<span class="string">&quot;@style/activityTheme&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--启动先预热第二引擎页面，oncreate里面再切换回app主页--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--启动的时候加背景图防止黑屏--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;io.flutter.embedding.android.SplashScreenDrawable&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:resource</span>=<span class="string">&quot;@drawable/launch_background&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ol start="2">
<li><p>在预热web activity过程中，如果不注意两个activity engine注册插件先后顺序和冲突，会出现flutter和原生交互找不到method方法报错，需要按照下面的顺序来</p>
<ul>
<li><p>在Application onCreate方法里预热web引擎，automaticallyRegisterPlugins一定要传false</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="title">extends</span> <span class="title">FlutterApplication</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> void onCreate() &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//启动预加载一个引擎for 单例 webview 不自动注册插件</span></span><br><span class="line">        FlutterEngine webEngine = new FlutterEngine(<span class="keyword">this</span>,<span class="literal">null</span>,<span class="literal">false</span>);</span><br><span class="line">        FlutterEngineCache.getInstance().put(WebEngine.ENGINE_ID,webEngine);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<ul>
<li><ul>
<li><p>继承FlutterActivity类，覆写获取engine方法，拿到已经预热好的engine</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载预热的引擎，在my_app类中创建</span></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">provideFlutterEngine</span><span class="params">(context: <span class="type">Context</span>)</span></span>: FlutterEngine? &#123;</span><br><span class="line">    <span class="comment">//return super.provideFlutterEngine(context)</span></span><br><span class="line">    <span class="keyword">return</span> FlutterEngineCache.getInstance().<span class="keyword">get</span>(WebEngine.ENGINE_ID)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><ul>
<li><p>执行指定的entry point</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">configureFlutterEngine</span><span class="params">(flutterEngine: <span class="type">FlutterEngine</span>)</span></span> &#123;</span><br><span class="line">    runEntrypoint(flutterEngine)</span><br><span class="line">    <span class="keyword">super</span>.configureFlutterEngine(flutterEngine)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<p>这样，两端就都可以实现H5“秒开”体验。</p>
<p>完。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://pluscool.cn/2021/05/07/unix-tool/mac-keyboard-not-working/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="张俊凯">
      <meta itemprop="description" content="种点粮食">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="加酷知识源">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/07/unix-tool/mac-keyboard-not-working/" class="post-title-link" itemprop="url">mac触摸板和键盘失灵</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-05-07 09:31:05 / Modified: 09:38:57" itemprop="dateCreated datePublished" datetime="2021-05-07T09:31:05+08:00">2021-05-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/unix/" itemprop="url" rel="index"><span itemprop="name">unix</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>症状：</p>
<blockquote>
<p>除了电源按钮，键盘和触摸板全部失灵，触摸板可以按下去，鼠标无法滑动，外接usb键盘鼠标可以使用</p>
</blockquote>
<p>处理办法:</p>
<blockquote>
<p>重置NVRAM</p>
<p>步骤：首先按住 option+commamd+P+R键，再按住电源键开机，等待听duang的开机声，听到四声后，松开按键，按电源键开机，恢复正常</p>
</blockquote>
<p>参考：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/51d6142b564a">https://www.jianshu.com/p/51d6142b564a</a></p>
<p>完。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://pluscool.cn/2021/04/28/iOS/github-443-problem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="张俊凯">
      <meta itemprop="description" content="种点粮食">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="加酷知识源">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/28/iOS/github-443-problem/" class="post-title-link" itemprop="url">pod下载三方库github 443问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-04-28 09:59:55 / Modified: 10:13:32" itemprop="dateCreated datePublished" datetime="2021-04-28T09:59:55+08:00">2021-04-28</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>报错原文：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cloning into &#x27;/var/folders/nd/n2mbp09n1lqbyyf586wntcww0000gn/T/d20210428-5764-pwxnoe&#x27;...</span><br><span class="line">fatal: unable to access &#x27;https://github.com/SDWebImage/SDWebImage.git/&#x27;: LibreSSL SSL_connect: SSL_ERROR_SYSCALL in connection to github.com:443 </span><br></pre></td></tr></table></figure>

<p>原因分析：</p>
<blockquote>
<p> 本地git使用代理连接github，代理出了问题</p>
</blockquote>
<p>问题解决：</p>
<blockquote>
<p>让代理恢复正常或者不使用代理</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global --unset http.https://github.com.proxy</span><br><span class="line">git config --global --unset https.https://github.com.proxy</span><br></pre></td></tr></table></figure>

<blockquote>
<p>去除了http 和 https的代理</p>
</blockquote>
<p>完。</p>
<p>参考：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/388c2914f22a">https://www.jianshu.com/p/388c2914f22a</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://pluscool.cn/2021/04/13/iOS/UI-WK-differences/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="张俊凯">
      <meta itemprop="description" content="种点粮食">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="加酷知识源">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/13/iOS/UI-WK-differences/" class="post-title-link" itemprop="url">Why use WKWebview</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-04-13 12:35:48 / Modified: 01:03:35" itemprop="dateCreated datePublished" datetime="2021-04-13T12:35:48+08:00">2021-04-13</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​       WK is run in a separate process so that it can draw on native Safari JavaScript optimizations,this means WK loads web pages faster than UIWeb,UIWeb uses traditional JS engines which are basic interpreters,Apple’s Nitro engine uses a 4 tier compiling strategy which can execute JS 40 times faster than a traditional JS interpreter.</p>
<p>Nitro means Nitromethane, is a kind of fuel for car engine.</p>
<p>source：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/example-code/wkwebview/whats-the-difference-between-uiwebview-and-wkwebview#:~:text=Second%2C%20WKWebView%20is%20run%20in,much%20memory%20overhead%20for%20you">https://www.hackingwithswift.com/example-code/wkwebview/whats-the-difference-between-uiwebview-and-wkwebview#:~:text=Second%2C%20WKWebView%20is%20run%20in,much%20memory%20overhead%20for%20you</a></li>
<li><a target="_blank" rel="noopener" href="https://zoompf.com/blog/2014/06/apples-nitro-javascript-engine-available-to-all-apps/">https://zoompf.com/blog/2014/06/apples-nitro-javascript-engine-available-to-all-apps/</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://pluscool.cn/2021/04/12/algo/find-next-numnbe-advance/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="张俊凯">
      <meta itemprop="description" content="种点粮食">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="加酷知识源">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/12/algo/find-next-numnbe-advance/" class="post-title-link" itemprop="url">寻找下一个数</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-04-12 23:03:38 / Modified: 18:48:49" itemprop="dateCreated datePublished" datetime="2021-04-12T23:03:38+08:00">2021-04-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>早上开车等红绿灯时想到几个月前写的一个算法，应该可以更简单，今天重新写了一遍</p>
<ul>
<li><p>寻找下一个数字，例如输入345，输出354</p>
<blockquote>
<p>思路：从最右边位和上一位对比，如果大，就往前移，移动完，尾数排序，从小到大，保证次大</p>
</blockquote>
</li>
<li><p>代码</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;字符串分成数组</span><br><span class="line">NSMutableArray *convertStringToArray(NSString *str)&#123;</span><br><span class="line">    NSMutableArray *marr &#x3D; [NSMutableArray array];</span><br><span class="line">    for (NSInteger i &#x3D; 0; i &lt; str.length; i++) &#123;</span><br><span class="line">        [marr addObject:[str substringWithRange:NSMakeRange(i, 1)]];</span><br><span class="line">    &#125;</span><br><span class="line">    return marr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;数组拼成字符串</span><br><span class="line">NSString *convertArrayToString(NSArray *arr)&#123;</span><br><span class="line">    NSMutableString *mstr &#x3D; [NSMutableString string];</span><br><span class="line">    for (NSString *str in arr) &#123;</span><br><span class="line">        [mstr appendString:str];</span><br><span class="line">    &#125;</span><br><span class="line">    return mstr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;冒泡排序 从小到大</span><br><span class="line">NSString *bubbleSort(NSString *str)&#123;</span><br><span class="line">    NSArray *sortedArray &#x3D; convertStringToArray(str);</span><br><span class="line">    NSMutableArray *marr &#x3D; [NSMutableArray arrayWithArray:sortedArray];</span><br><span class="line">    &#x2F;&#x2F;最后一位的索引</span><br><span class="line">    unsigned long j &#x3D; marr.count-1;</span><br><span class="line">    for (;j&gt;0;j--) &#123;</span><br><span class="line">      </span><br><span class="line">        BOOL didSort &#x3D; NO;</span><br><span class="line">        &#x2F;&#x2F;第一轮结束</span><br><span class="line">        for (int i&#x3D;0; i&lt;j; i++) &#123;</span><br><span class="line">            NSString *pre &#x3D; marr[i];</span><br><span class="line">            NSString *next &#x3D; marr[i+1];</span><br><span class="line">            if (pre.integerValue &gt; next.integerValue) &#123;</span><br><span class="line">                [marr exchangeObjectAtIndex:i+1 withObjectAtIndex:i];</span><br><span class="line">                didSort &#x3D; YES;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        if (!didSort) &#123;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    NSMutableString *mstr &#x3D; [NSMutableString string];</span><br><span class="line">    for (NSString *str in marr) &#123;</span><br><span class="line">        [mstr appendString:str];</span><br><span class="line">    &#125;</span><br><span class="line">    return  mstr;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSString *findNextLargerNum(NSString *oriNum)&#123;</span><br><span class="line">    NSString *resultStr &#x3D; oriNum;</span><br><span class="line">    NSMutableArray *oriNumMArr &#x3D;[NSMutableArray arrayWithArray:convertStringToArray(oriNum)];</span><br><span class="line">    </span><br><span class="line">    for (int j &#x3D; oriNumMArr.count-1; j&gt;0; j--) &#123;</span><br><span class="line">        </span><br><span class="line">        BOOL getResult &#x3D; NO;</span><br><span class="line">        NSString *last &#x3D; oriNumMArr[j];</span><br><span class="line">        for (int i &#x3D; j-1; i&gt;&#x3D;0; i--) &#123;</span><br><span class="line">            NSString *pre &#x3D; oriNumMArr[i];</span><br><span class="line">            if (last.integerValue &gt; pre.integerValue) &#123;</span><br><span class="line">                 [oriNumMArr exchangeObjectAtIndex:i withObjectAtIndex:j];</span><br><span class="line">                NSRange range &#x3D; NSMakeRange(i+1, oriNumMArr.count - 1 - i);</span><br><span class="line">                NSString *surfixStr &#x3D; convertArrayToString([oriNumMArr subarrayWithRange:range]);</span><br><span class="line">                NSString *surResultStr &#x3D; bubbleSort(surfixStr);</span><br><span class="line">                NSString *preStr &#x3D; convertArrayToString([oriNumMArr subarrayWithRange:NSMakeRange(0,i+1)]);</span><br><span class="line">                resultStr &#x3D; [NSString stringWithFormat:@&quot;%@%@&quot;,preStr,surResultStr];</span><br><span class="line">                getResult &#x3D; YES;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        if (getResult) &#123;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    return resultStr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="使用："><a href="#使用：" class="headerlink" title="使用："></a>使用：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NSString *str &#x3D; findNextLargerNum(@&quot;8976&quot;);</span><br><span class="line">NSLog(@&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;%@&quot;,str);</span><br><span class="line">&#x2F;&#x2F;打印结果</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;9678</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://pluscool.cn/2021/04/11/flutter/flutter-app-optimization-example/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="张俊凯">
      <meta itemprop="description" content="种点粮食">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="加酷知识源">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/11/flutter/flutter-app-optimization-example/" class="post-title-link" itemprop="url">flutter App 优化实操</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-11 17:50:00" itemprop="dateCreated datePublished" datetime="2021-04-11T17:50:00+08:00">2021-04-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-01 17:46:09" itemprop="dateModified" datetime="2021-04-01T17:46:09+08:00">2021-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/flutter/" itemprop="url" rel="index"><span itemprop="name">flutter</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li><p>抽取widget，尽量成为一个stateless widget</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Expanded(</span><br><span class="line">      child: Container(</span><br><span class="line">        color: Colors.grey[<span class="number">700</span>],</span><br><span class="line">        child: Center(</span><br><span class="line">          child: Text(</span><br><span class="line">            <span class="string">&#x27;Hello Flutter&#x27;</span>,</span><br><span class="line">            style: Theme.of(context).textTheme.display1,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>更新属性值，用传值的方式</p>
<ul>
<li><p>ChangeNotifier</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;------ ChangeNotifier class ----&#x2F;&#x2F;</span><br><span class="line">class MyColorNotifier extends ChangeNotifier &#123;</span><br><span class="line">  Color myColor &#x3D; Colors.grey;</span><br><span class="line">  Random _random &#x3D; new Random();</span><br><span class="line"></span><br><span class="line">  void changeColor() &#123;</span><br><span class="line">    int randomNumber &#x3D; _random.nextInt(30);</span><br><span class="line">    myColor &#x3D; Colors.primaries[randomNumber % Colors.primaries.length];</span><br><span class="line">    notifyListeners();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;------ State class ----&#x2F;&#x2F;</span><br><span class="line"></span><br><span class="line">class _MyHomePageState extends State&lt;MyHomePage&gt; &#123;</span><br><span class="line">  final _colorNotifier &#x3D; MyColorNotifier();</span><br><span class="line"></span><br><span class="line">  void _onPressed() &#123;</span><br><span class="line">    _colorNotifier.changeColor();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  void dispose() &#123;</span><br><span class="line">    _colorNotifier.dispose();</span><br><span class="line">    super.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    print(&#39;building &#96;MyHomePage&#96;&#39;);</span><br><span class="line">    return Scaffold(</span><br><span class="line">      floatingActionButton: FloatingActionButton(</span><br><span class="line">        onPressed: _onPressed,</span><br><span class="line">        child: Icon(Icons.colorize),</span><br><span class="line">      ),</span><br><span class="line">      body: Stack(</span><br><span class="line">        children: [</span><br><span class="line">          Positioned.fill(</span><br><span class="line">            child: BackgroundWidget(),</span><br><span class="line">          ),</span><br><span class="line">          Center(</span><br><span class="line">            child: AnimatedBuilder(</span><br><span class="line">              animation: _colorNotifier,</span><br><span class="line">              builder: (_, __) &#x3D;&gt; Container(</span><br><span class="line">                height: 150,</span><br><span class="line">                width: 150,</span><br><span class="line">                color: _colorNotifier.myColor,</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<ul>
<li><p>ValueNotifier</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyHomePageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyHomePage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> _colorNotifier = ValueNotifier&lt;Color&gt;(Colors.grey);</span><br><span class="line">  Random _random = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> _onPressed() &#123;</span><br><span class="line">    <span class="built_in">int</span> randomNumber = _random.nextInt(<span class="number">30</span>);</span><br><span class="line">    _colorNotifier.value =</span><br><span class="line">        Colors.primaries[randomNumber % Colors.primaries.length];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    _colorNotifier.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;building `MyHomePage`&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      floatingActionButton: FloatingActionButton(</span><br><span class="line">        onPressed: _onPressed,</span><br><span class="line">        child: Icon(Icons.colorize),</span><br><span class="line">      ),</span><br><span class="line">      body: Stack(</span><br><span class="line">        children: [</span><br><span class="line">          Positioned.fill(</span><br><span class="line">            child: BackgroundWidget(),</span><br><span class="line">          ),</span><br><span class="line">          Center(</span><br><span class="line">            child: ValueListenableBuilder(</span><br><span class="line">              valueListenable: _colorNotifier,</span><br><span class="line">              builder: (_, value, __) =&gt; Container(</span><br><span class="line">                height: <span class="number">150</span>,</span><br><span class="line">                width: <span class="number">150</span>,</span><br><span class="line">                color: value,</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用const修饰stateless widget，set state不会重复刷新</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BackgroundWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> BackgroundWidget();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;building `BackgroundWidget`&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> Image.network(</span><br><span class="line">      <span class="string">&#x27;https://cdn.pixabay.com/photo/2017/08/30/01/05/milky-way-2695569_960_720.jpg&#x27;</span>,</span><br><span class="line">      fit: BoxFit.cover,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>生成列表的时候使用itemExtent属性告诉系统item高度，更高效的滑动</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHomePage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> widgets = <span class="built_in">List</span>.generate(</span><br><span class="line">    <span class="number">10000</span>,</span><br><span class="line">    (index) =&gt; Container(</span><br><span class="line">      color: Colors.primaries[index % Colors.primaries.length],</span><br><span class="line">      child: ListTile(</span><br><span class="line">        title: Text(<span class="string">&#x27;Index: <span class="subst">$index</span>&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> _scrollController = ScrollController();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> _onPressed() <span class="keyword">async</span> &#123;</span><br><span class="line">    _scrollController.jumpTo(</span><br><span class="line">      _scrollController.position.maxScrollExtent,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      floatingActionButton: FloatingActionButton(</span><br><span class="line">        onPressed: _onPressed,</span><br><span class="line">        splashColor: Colors.red,</span><br><span class="line">        child: Icon(Icons.slow_motion_video),</span><br><span class="line">      ),</span><br><span class="line">      body: ListView(</span><br><span class="line">        controller: _scrollController,</span><br><span class="line">        children: widgets,</span><br><span class="line">        itemExtent: <span class="number">200</span>,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>需要动画的子控件设置给AnimatedBuilder的child，避免重复绘制</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      floatingActionButton: FloatingActionButton(</span><br><span class="line">        onPressed: _onPressed,</span><br><span class="line">        splashColor: Colors.red,</span><br><span class="line">        child: Icon(Icons.slow_motion_video),</span><br><span class="line">      ),</span><br><span class="line">      body: AnimatedBuilder(</span><br><span class="line">        animation: _controller,</span><br><span class="line">        child: CounterWidget(</span><br><span class="line">          counter: counter,</span><br><span class="line">        ),</span><br><span class="line">        builder: (_, child) =&gt; Transform(</span><br><span class="line">          alignment: Alignment.center,</span><br><span class="line">          transform: Matrix4.identity()</span><br><span class="line">            ..setEntry(<span class="number">3</span>, <span class="number">2</span>, <span class="number">0.001</span>)</span><br><span class="line">            ..rotateY(<span class="number">360</span> * _controller.value * (pi / <span class="number">180.0</span>)),</span><br><span class="line">          child: child,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>合理使用opacity属性，减少调用setlayer方法，触发离屏渲染</p>
<ul>
<li><p>使用fadeTransition</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyHomePageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyHomePage</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="title">with</span> <span class="title">SingleTickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  AnimationController _controller;</span><br><span class="line">  <span class="built_in">int</span> counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> _onPressed() &#123;</span><br><span class="line">    setState(() &#123;</span><br><span class="line">      counter++;</span><br><span class="line">    &#125;);</span><br><span class="line">    _controller.forward(from: <span class="number">0.0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    _controller = AnimationController(</span><br><span class="line">        vsync: <span class="keyword">this</span>, duration: <span class="keyword">const</span> <span class="built_in">Duration</span>(milliseconds: <span class="number">600</span>));</span><br><span class="line">    _controller.addStatusListener((status) &#123;</span><br><span class="line">      <span class="keyword">if</span> (status == AnimationStatus.completed) &#123;</span><br><span class="line">        _controller.reverse();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    _controller.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      floatingActionButton: FloatingActionButton(</span><br><span class="line">        onPressed: _onPressed,</span><br><span class="line">        splashColor: Colors.red,</span><br><span class="line">        child: Icon(Icons.slow_motion_video),</span><br><span class="line">      ),</span><br><span class="line">      body: FadeTransition(</span><br><span class="line">        opacity: Tween(begin: <span class="number">1.0</span>, end: <span class="number">0.0</span>).animate(_controller),</span><br><span class="line">        child: CounterWidget(</span><br><span class="line">          counter: counter,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<ul>
<li><p>使用animatedOpacity</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> duration = <span class="keyword">const</span> <span class="built_in">Duration</span>(milliseconds: <span class="number">600</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyHomePageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyHomePage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="built_in">int</span> counter = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">double</span> opacity = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> _onPressed() <span class="keyword">async</span> &#123;</span><br><span class="line">    counter++;</span><br><span class="line">    setState(() &#123;</span><br><span class="line">      opacity = <span class="number">0.0</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">await</span> Future.delayed(duration);</span><br><span class="line">    setState(() &#123;</span><br><span class="line">      opacity = <span class="number">1.0</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      floatingActionButton: FloatingActionButton(</span><br><span class="line">        onPressed: _onPressed,</span><br><span class="line">        splashColor: Colors.red,</span><br><span class="line">        child: Icon(Icons.slow_motion_video),</span><br><span class="line">      ),</span><br><span class="line">      body: AnimatedOpacity(</span><br><span class="line">        opacity: opacity,</span><br><span class="line">        duration: duration,</span><br><span class="line">        child: CounterWidget(</span><br><span class="line">          counter: counter,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<p>完。</p>
<p>sources:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.codemagic.io/how-to-improve-the-performance-of-your-flutter-app./">https://blog.codemagic.io/how-to-improve-the-performance-of-your-flutter-app./</a></li>
<li><a href="https://pluscool.cn/2021/03/31/flutter/flutter-app-optimize/">https://pluscool.cn/2021/03/31/flutter/flutter-app-optimize/</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://pluscool.cn/2021/04/11/flutter/flutter-relese-apk-do-not-work/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="张俊凯">
      <meta itemprop="description" content="种点粮食">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="加酷知识源">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/11/flutter/flutter-relese-apk-do-not-work/" class="post-title-link" itemprop="url">flutter安卓release包代码无法执行</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-11 09:18:49" itemprop="dateCreated datePublished" datetime="2021-04-11T09:18:49+08:00">2021-04-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-01 09:57:13" itemprop="dateModified" datetime="2021-04-01T09:57:13+08:00">2021-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/flutter/" itemprop="url" rel="index"><span itemprop="name">flutter</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="问题描述："><a href="#问题描述：" class="headerlink" title="问题描述："></a>问题描述：</h2><p>flutter工程打包apk文件后</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">val</span> method = javaClass.getDeclaredMethod(call.method, MethodCall::<span class="keyword">class</span>.java, MethodChannel.Result::<span class="keyword">class</span>.java)</span><br><span class="line">    method.invoke(<span class="keyword">this</span>, call, result)</span><br><span class="line">&#125; <span class="keyword">catch</span> (e: NoSuchMethodException) &#123;</span><br><span class="line">    e.printStackTrace()</span><br><span class="line">&#125; <span class="keyword">catch</span> (e: IllegalAccessException) &#123;</span><br><span class="line">    e.printStackTrace()</span><br><span class="line">&#125; <span class="keyword">catch</span> (e: InvocationTargetException) &#123;</span><br><span class="line">    e.printStackTrace()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段代码无法执行</p>
<h2 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h2><p>经过咨询，安卓release包会代码混淆，使用反射会让代码无法精确匹配</p>
<h2 id="解决"><a href="#解决" class="headerlink" title="解决:"></a>解决:</h2><ul>
<li>使用反射的类不参与混淆，降低安全性</li>
<li>不使用反射，改用if判断或者switch case</li>
</ul>
<p>参考：1. <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/41525867/reflection-not-working-on-android-release-apk-even-with-proguard-minify-disable">https://stackoverflow.com/questions/41525867/reflection-not-working-on-android-release-apk-even-with-proguard-minify-disable</a></p>
<p>2.<a target="_blank" rel="noopener" href="https://blog.csdn.net/guohesheng/article/details/53696652">https://blog.csdn.net/guohesheng/article/details/53696652</a></p>
<p>3.<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/b5b2a5dfaaf4">https://www.jianshu.com/p/b5b2a5dfaaf4</a></p>
<p>感谢王志浩同学提供帮助！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://pluscool.cn/2021/03/31/flutter/flutter-app-optimize/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="张俊凯">
      <meta itemprop="description" content="种点粮食">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="加酷知识源">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/31/flutter/flutter-app-optimize/" class="post-title-link" itemprop="url">flutter App optimization</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-03-31 10:50:49 / Modified: 15:28:34" itemprop="dateCreated datePublished" datetime="2021-03-31T10:50:49+08:00">2021-03-31</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/flutter/" itemprop="url" rel="index"><span itemprop="name">flutter</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li><p>avoid costly work in build() since build() can be invoked frequently when ancestor Widgets rebuild</p>
</li>
<li><p>avoid calling setState() high up in the tree</p>
</li>
<li><p>Use the lazy methods, with callbacks,when building large grids or lists, that way only the visible portion of the screen is built at startup time</p>
</li>
<li><p>avoid invoke saveLayer(),including</p>
<ul>
<li>opacity widget</li>
<li>shaderMask</li>
<li>colorFilter</li>
<li>Clip</li>
<li>Text</li>
<li>addition:Clipping doesn’t call saveLayer() but is still costly</li>
</ul>
<p>Ways to avoid calls to saveLayer():</p>
<ul>
<li>To implement fading in an image, consider using the FadeInImage</li>
<li>using the border Radius property instead of applying a clipping rectangle</li>
</ul>
</li>
<li><p>build and display frames in 16ms</p>
</li>
<li><p>build  subtree widget once and pass it as a child to the AnimatedBuilder</p>
</li>
<li><p>pre-clip image before animating it</p>
</li>
<li><p>avoid using constructors with a concrete List of children if most of the children are not visible on  screen</p>
</li>
</ul>
<p>source:<a target="_blank" rel="noopener" href="https://flutter.dev/docs/perf/rendering/best-practices">https://flutter.dev/docs/perf/rendering/best-practices</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">张俊凯</p>
  <div class="site-description" itemprop="description">种点粮食</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">67</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">张俊凯</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
